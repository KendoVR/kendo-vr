<!DOCTYPE html>
<html>
    <head>
        <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script> 
        <script src="https://unpkg.com/aframe-debug-cursor-component/dist/aframe-debug-cursor-component.min.js"></script>
        <script src="./aframe-grid.js"></script>
    </head>
    <body>
        <a-scene>
            <a-entity id="mouseCursor" cursor="rayOrigin: mouse" debug-cursor></a-entity>
            <a-entity position="0 20 100">
                <a-camera></a-camera>
            </a-entity>            
            <kendo-webvr-grid id="grid" position="0 -0.6 -0.1" data="./data/data.json">
                <a-entity id="sort-button" geometry="primitive: box; width:20;height:10" material="color: blue" text="value: Blio" position="50 -10 -0.3" ></a>
            </kendo-webvr-grid>
            <a-sky color="#ECECEC"></a-sky>
        </a-scene>

        <script>
            document.querySelector('#sort-button').addEventListener('click', function() {
                let allCells = this.parentEl.getChildEntities().filter(function (item) { return parseInt(item.getAttribute("rowindex")) > 0});
                let oldCells = allCells.filter(item => item.getAttribute("colindex") == 0);

                let sortedCells = allCells.filter(item => item.getAttribute("colindex") == 0).sort(function(a, b) {
                    return a.getAttribute("text").value == b.getAttribute("text").value
                        ? 0
                        : (a.getAttribute("text").value > b.getAttribute("text").value ? 1 : -1);
                });
                    
                for (let i=0; i< sortedCells.length; i++) {
                    sortedCells[i].setAttribute("animation", {
                        property: "position",
                        dur: 500,
                        to: oldCells[i].getAttribute("position").toArray().toString().replace(",", " ")
                    })
                }
            });
        </script>
    </body>
</html>